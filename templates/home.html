{% extends "base2.html" %}
{% block content %}
<center>
    <div class="dashboard-app">
        <div class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Selecciona un patrimonio</a>
            <div class="dropdown-menu">
                <span id="input">
                <script>
                    var contador={{ubicaciones}}.length
                    var ubicaciones = {{ ubicaciones|tojson }}
                    var lista =[]
                    for{
                        patrimonio = ubicaciones[i].split(" ").join("+");
                        function generateURL(param_value) {
                            const baseURL = '/estadisticasTemporales/';
                            return baseURL + patrimonio;
                        }
                        lista.push('<a class="dropdown-item" href="' + generateURL(patrimonio) + '">' + ubicaciones[i] + '</a>');
                    document.getElementById('input').innerHTML = lista ;
                    };             
                </script>
            </div>
        </div>

        </script>
        <div style="position: absolute; top: 0; bottom: 0; left: 238px; right: 0;">
            <div id="map" style="height: 100%;"></div>
            <script type="text/javascript">
                // Crear un mapa y especificar su div contenedor y opciones
                var map = L.map('map', {
                    center: [42.37014,-5.030849],
                    zoom: 9
                });
                // AÃ±adir capas al mapa   
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
                maxZoom: 18
                }).addTo(map);

                var contador={{marcadores}}.length
                var ubicaciones = {{ ubicaciones|tojson }}
                
                for (var i = 0; i < contador; i++) {
                    
                    latitud={{marcadores}}[i][0]
                    longitud={{marcadores}}[i][1]
                    var marker = L.marker([latitud,longitud]).addTo(map)
                    patrimonio = ubicaciones[i].split(" ").join("+");
                    function generateURL(param_value) {
                        const baseURL = '/estadisticasTemporales/';
                        return baseURL + patrimonio;
                    }
                    
                    marker.bindPopup('<a href="' + generateURL(patrimonio) + '">' + ubicaciones[i] + '</a>').openPopup();
                };             
        </script>
        
    </div>  
</center> 
{% endblock %}